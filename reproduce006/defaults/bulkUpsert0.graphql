upsert {
  query {
    movies(func: has(properties), first:1 ) @filter(eq(type,"node") AND NOT has(migrationDone) ) {
      v as uid
      Labels as labels
      properties {
        # delProps as uid
        Title as title
        Released as released
        Tagline as tagline
        Born as born
        Name as name
      }
        TitleMe as sum(val(Title))
        ReleasedMe as sum(val(Released))
        TaglineMe as sum(val(Tagline))
        BornMe as sum(val(Born))
        NameMe as sum(val(Name))
    }

  }

  mutation {
    set {
      uid(v) <migrationDone> "True" .
      uid(v) <title> val(TitleMe) .
      uid(v) <released> val(ReleasedMe) .
      uid(v) <tagline> val(TaglineMe) .
      uid(v) <dgraph.type> val(Labels) .
      uid(v) <born> val(BornMe) .
      uid(v) <name> val(NameMe) .
    }
  }
}
